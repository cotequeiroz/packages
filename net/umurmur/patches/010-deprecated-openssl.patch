--- a/src/ssli_openssl.c
+++ b/src/ssli_openssl.c
@@ -44,6 +44,9 @@
 #include <openssl/ssl.h>
 #include <openssl/err.h>
 #include <openssl/safestack.h>
+#ifndef OPENSSL_NO_EC
+#include <openssl/ec.h>
+#endif
 static X509 *x509;
 static RSA *rsa;
 static SSL_CTX *context;
@@ -234,9 +237,11 @@ void SSLi_init(void)
 
 	SSL_CTX_set_cipher_list(context, ciphers);
 
+#ifndef OPENSSL_NO_EC
 	EC_KEY *ecdhkey = EC_KEY_new_by_curve_name(NID_X9_62_prime256v1);
 	SSL_CTX_set_tmp_ecdh(context, ecdhkey);
 	EC_KEY_free(ecdhkey);
+#endif
 
 	char const * sslCAPath = getStrConf(CAPATH);
 	if(sslCAPath != NULL)
