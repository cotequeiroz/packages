--- a/evhtp.c
+++ b/evhtp.c
@@ -1694,8 +1694,12 @@ _evhtp_ssl_delete_scache_ent(evhtp_ssl_c
     htp  = (evhtp_t *)SSL_CTX_get_app_data(ctx);
     cfg  = htp->ssl_cfg;
 
+#if OPENSSL_VERSION_NUMBER >= 0x10100000L
+    sid = (unsigned char *)SSL_SESSION_get_id(sess, (unsigned int *)&slen);
+#else
     sid  = sess->session_id;
     slen = sess->session_id_length;
+#endif
 
     if (cfg->scache_del) {
         (cfg->scache_del)(htp, sid, slen);
@@ -1712,8 +1716,12 @@ _evhtp_ssl_add_scache_ent(evhtp_ssl_t *
     connection = (evhtp_connection_t *)SSL_get_app_data(ssl);
     cfg        = connection->htp->ssl_cfg;
 
-    sid        = sess->session_id;
-    slen       = sess->session_id_length;
+#if OPENSSL_VERSION_NUMBER >= 0x10100000L
+    sid = (unsigned char *)SSL_SESSION_get_id(sess, (unsigned int *)&slen);
+#else
+    sid  = sess->session_id;
+    slen = sess->session_id_length;
+#endif
 
     SSL_set_timeout(sess, cfg->scache_timeout);
 
@@ -1725,7 +1733,11 @@ _evhtp_ssl_add_scache_ent(evhtp_ssl_t *
 }
 
 static evhtp_ssl_sess_t *
+#if OPENSSL_VERSION_NUMBER >= 0x10100000L
+_evhtp_ssl_get_scache_ent(evhtp_ssl_t * ssl, const unsigned char * sid, int sid_len, int * copy) {
+#else
 _evhtp_ssl_get_scache_ent(evhtp_ssl_t * ssl, unsigned char * sid, int sid_len, int * copy) {
+#endif
     evhtp_connection_t * connection;
     evhtp_ssl_cfg_t    * cfg;
     evhtp_ssl_sess_t   * sess;
@@ -1735,7 +1747,7 @@ _evhtp_ssl_get_scache_ent(evhtp_ssl_t *
     sess       = NULL;
 
     if (cfg->scache_get) {
-        sess = (cfg->scache_get)(connection, sid, sid_len);
+        sess = (cfg->scache_get)(connection, (unsigned char *) sid, sid_len);
     }
 
     *copy = 0;
@@ -1767,12 +1779,12 @@ _evhtp_ssl_servername(evhtp_ssl_t * ssl,
         connection->vhost_via_sni = 1;
 
         SSL_set_SSL_CTX(ssl, evhtp_vhost->ssl_ctx);
-        SSL_set_options(ssl, SSL_CTX_get_options(ssl->ctx));
+        SSL_set_options(ssl, SSL_CTX_get_options(SSL_get_SSL_CTX(ssl)));
 
         if ((SSL_get_verify_mode(ssl) == SSL_VERIFY_NONE) ||
             (SSL_num_renegotiations(ssl) == 0)) {
-            SSL_set_verify(ssl, SSL_CTX_get_verify_mode(ssl->ctx),
-                           SSL_CTX_get_verify_callback(ssl->ctx));
+            SSL_set_verify(ssl, SSL_CTX_get_verify_mode(SSL_get_SSL_CTX(ssl)),
+                           SSL_CTX_get_verify_callback(SSL_get_SSL_CTX(ssl)));
         }
 
         return SSL_TLSEXT_ERR_OK;
@@ -3062,7 +3074,11 @@ evhtp_ssl_init(evhtp_t * htp, evhtp_ssl_
     SSL_CTX_set_verify(htp->ssl_ctx, cfg->verify_peer, cfg->x509_verify_cb);
 
     if (cfg->x509_chk_issued_cb != NULL) {
+#if OPENSSL_VERSION_NUMBER >= 0x10100000L
+	X509_STORE_set_check_issued(SSL_CTX_get_cert_store(htp->ssl_ctx), cfg->x509_chk_issued_cb);
+#else
         htp->ssl_ctx->cert_store->check_issued = cfg->x509_chk_issued_cb;
+#endif
     }
 
     if (cfg->verify_depth) {
